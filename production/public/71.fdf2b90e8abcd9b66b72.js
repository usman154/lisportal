"use strict";(self.webpackChunk_fuse_demo=self.webpackChunk_fuse_demo||[]).push([[71],{20071:(Pt,Q,s)=>{s.r(Q),s.d(Q,{ContactsModule:()=>Bt});var m=s(63423),T=s(51095),B=s(7539),b=s(72458),h=s(43220),O=s(1769),C=s(98295),y=s(76627),R=s(83166),P=s(33935),E=s(36063),j=s(12178),A=s(82613),J=s(67441),Z=s(23017),H=s(32789),D=s(11436),S=s(16738),z=s(7853),G=s(44466),t=s(37716);let $=(()=>{class o{canDeactivate(e,n,a,c){let i=c.root;for(;i.firstChild;)i=i.firstChild;return!(c.url.includes("/contacts")&&!i.paramMap.get("id"))||e.closeDrawer().then(()=>!0)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var x=s(51999);let V=(()=>{class o{constructor(e){this._contactsService=e}resolve(e,n){return this._contactsService.getContacts()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(x.P))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),W=(()=>{class o{constructor(e){this._contactsService=e}resolve(e,n){return this._contactsService.getCountries()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(x.P))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),K=(()=>{class o{constructor(e){this._contactsService=e}resolve(e,n){return this._contactsService.getTags()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(x.P))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),X=(()=>{class o{constructor(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["contacts"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"router-outlet")},directives:[m.lC],encapsulation:2,changeDetection:0}),o})();var g=s(8239),v=s(38583),d=s(3679),U=s(79765),tt=s(22759),p=s(46782),et=s(43190),nt=s(45435),ot=s(91841);let F=(()=>{class o{constructor(e){this._httpClient=e}getFormsData(e="pending",n=0,a=30,c="",i="",l=""){return new Promise((u,f)=>{this._httpClient.get(window.appBaseUrl+`/forms?start=${i}&end=${l}&filter=${e}&page=${n}&size=${a}&name=${c}`).subscribe(_=>{u(_)},f)})}getFormData(e){return new Promise((n,a)=>{this._httpClient.get(window.appBaseUrl+"/forms/"+e).subscribe(c=>{n(c)},a)})}updateFormResults(e,n){return new Promise((a,c)=>{this._httpClient.put(window.appBaseUrl+"/forms/"+e,n).subscribe(i=>{a(i)},c)})}sendReportEmail(e){return new Promise((n,a)=>{this._httpClient.post(window.appBaseUrl+"/forms/emailReport",{contact:e}).subscribe(c=>{n(c)},a)})}downloadFile(e,n="data"){let a=this.ConvertToCSV(e,["Full Name","Address","DOB","Collection Date","Test Done","Insurance ID","Email","Phone"]);console.log(a);let c=new Blob(["\ufeff"+a],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),l=URL.createObjectURL(c);-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&i.setAttribute("target","_blank"),i.setAttribute("href",l),i.setAttribute("download",n+".csv"),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}ConvertToCSV(e,n){let a="object"!=typeof e?JSON.parse(e):e,c="",i="S.No,";for(let l in n)i+=n[l]+",";i=i.slice(0,-1),c+=i+"\r\n";for(let l=0;l<a.length;l++){let u=l+1+"";for(let f in n)u+=","+a[l][n[f]];c+=u+"\r\n"}return c}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(ot.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();var at=s(91812),Y=s(4885),q=s(99692);const rt=["matDrawer"];function it(o,r){1&o&&(t.TgZ(0,"div",32),t._UZ(1,"mat-progress-spinner",33),t.qZA()),2&o&&(t.xp6(1),t.Q6J("diameter",30)("mode","indeterminate"))}function st(o,r){if(1&o&&(t.ynx(0),t._UZ(1,"img",40),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.signature,t.LSH)}}const ct=function(o,r){return{"hover:bg-gray-100 dark:hover:bg-hover":o,"bg-primary-50 dark:bg-hover":r}},lt=function(o){return["./",o]};function dt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"a",35),t.TgZ(2,"div",36),t.YNc(3,st,2,1,"ng-container",28),t.qZA(),t.TgZ(4,"div",37),t.TgZ(5,"div",38),t.TgZ(6,"div",39),t._uU(7),t.qZA(),t.TgZ(8,"div",39),t._uU(9),t.qZA(),t.TgZ(10,"div",39),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()),2&o){const e=r.$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("ngClass",t.WLB(10,ct,!n.selectedContact||n.selectedContact._id!==e._id,n.selectedContact&&n.selectedContact._id===e._id))("routerLink",t.VKq(13,lt,e._id)),t.xp6(2),t.Q6J("ngIf",e.avatar),t.xp6(3),t.Q6J("matTooltip","Name"),t.xp6(1),t.AsE("",e.last_name,", ",e.first_name," "),t.xp6(1),t.Q6J("matTooltip","Location"),t.xp6(1),t.Oqu(e.location),t.xp6(1),t.Q6J("matTooltip","Collection Date"),t.xp6(1),t.Oqu(e.collection_date.month+"/"+e.collection_date.day+"/"+e.collection_date.year)}}function ut(o,r){if(1&o&&(t.ynx(0),t.YNc(1,dt,12,15,"ng-container",34),t.BQk()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",n.trackByFn)}}function mt(o,r){if(1&o&&(t.ynx(0),t.YNc(1,it,2,2,"div",30),t.YNc(2,ut,2,2,"ng-container",31),t.BQk()),2&o){const e=r.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.contactsLoading),t.xp6(1),t.Q6J("ngIf",e.length&&!n.contactsLoading)("ngIfElse",n.noContacts)}}function gt(o,r){1&o&&(t.TgZ(0,"div",42),t._uU(1,"There are no patients!"),t.qZA())}function pt(o,r){1&o&&t.YNc(0,gt,2,0,"ng-template",null,41,t.W1O)}const ft=function(o){return{"pointer-events-none":o}},_t=function(){return[5,10,25,100]};function ht(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"mat-paginator",43),t.NdJ("page",function(a){return t.CHM(e),t.oxw().paginationFilterRun(a)}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("ngClass",t.VKq(6,ft,e.isLoading))("length",e.patientsData.totalDocs)("pageIndex",e.patientsData.page-1)("pageSize",e.patientsData.limit)("pageSizeOptions",t.DdM(8,_t))("showFirstLastButtons",!0)}}let L=(()=>{class o{constructor(e,n,a,c,i,l,u){this._activatedRoute=e,this._changeDetectorRef=n,this._contactsService=a,this._formsService=c,this._document=i,this._router=l,this._fuseMediaWatcherService=u,this.range=new d.cw({start:new d.NI,end:new d.NI}),this.contactsCount=0,this.contactsTableColumns=["name","email","phoneNumber","job"],this.isLoading=!1,this.searchInputControl=new d.NI,this._unsubscribeAll=new U.xQ}onDateChange(){if(!this.range.value.end||this.range.value.start)return;const e=this.range.value.start.format("MM/DD/YYYY HH:mm:ss"),n=this.range.value.end.format("MM/DD/YYYY HH:mm:ss");this.patientsFilterData.start=e,this.patientsFilterData.end=n,this.patientsFilterRun()}ngOnInit(){var e=this;return(0,g.Z)(function*(){e.patientsData=yield e._formsService.getFormsData(),e.contacts$=e.patientsData.docs,e.patientsFilter="pending",e.patientsFilterData={},e.contactsLoading=!1,e._contactsService.contact$.pipe((0,p.R)(e._unsubscribeAll)).subscribe(n=>{e.selectedContact=n,e._changeDetectorRef.markForCheck()}),e._contactsService.countries$.pipe((0,p.R)(e._unsubscribeAll)).subscribe(n=>{e.countries=n,e._changeDetectorRef.markForCheck()}),e.searchInputControl.valueChanges.pipe((0,p.R)(e._unsubscribeAll),(0,et.w)(n=>e._contactsService.searchContacts(n))).subscribe(),e.matDrawer.openedChange.subscribe(n=>{n||(e.selectedContact=null,e._changeDetectorRef.markForCheck())}),e._fuseMediaWatcherService.onMediaChange$.pipe((0,p.R)(e._unsubscribeAll)).subscribe(({matchingAliases:n})=>{e.drawerMode=n.includes("lg")?"side":"over",e._changeDetectorRef.markForCheck()}),(0,tt.R)(e._document,"keydown").pipe((0,p.R)(e._unsubscribeAll),(0,nt.h)(n=>(!0===n.ctrlKey||n.metaKey)&&"/"===n.key)).subscribe(()=>{e.createContact()})})()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}patientsFilterRun(){var e=this;return(0,g.Z)(function*(){e.contactsLoading=!0,e.patientsData=yield e._formsService.getFormsData(e.patientsFilter,e.patientsFilterData.pageIndex,e.patientsFilterData.pageSize,e.patientsFilterData.first_name,e.patientsFilterData.start,e.patientsFilterData.end),e.contacts$=e.patientsData.docs,e.contactsLoading=!1,e._changeDetectorRef.markForCheck()})()}exportData(){var e=this;return(0,g.Z)(function*(){var n;const a=yield e._formsService.getFormsData(e.patientsFilter,e.patientsFilterData.pageIndex,1e7,"",e.patientsFilterData.start,e.patientsFilterData.end),c=null===(n=null==a?void 0:a.docs)||void 0===n?void 0:n.map(i=>({"Full Name":i.first_name+" "+i.last_name,Address:i.address.addr_line1+" "+i.address.city+" "+i.address.state+" "+i.address.postal,DOB:i.date_of_birth.day+"/"+i.date_of_birth.month+"/"+i.date_of_birth.year,"Collection Date":i.collection_date.day+"/"+i.collection_date.month+"/"+i.collection_date.year,"Test Done":i.selected_tests.toString(),"Insurance ID":i.insurance_id,Email:i.email,Phone:i.phone_number.full}));e._formsService.downloadFile(c,(new Date).toDateString())})()}paginationFilterRun(e){var n=this;return(0,g.Z)(function*(){const{pageIndex:a,pageSize:c}=e;n.patientsFilterData.pageIndex=a,n.patientsFilterData.pageSize=c,n.patientsFilterRun()})()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}filterPatients(e){var n=this;return(0,g.Z)(function*(){n.patientsFilterData.first_name=e,yield n.patientsFilterRun()})()}createContact(){this._contactsService.createContact().subscribe(e=>{this._router.navigate(["./",e.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}trackByFn(e,n){return n.id||e}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.gz),t.Y36(t.sBO),t.Y36(x.P),t.Y36(F),t.Y36(v.K0),t.Y36(m.F0),t.Y36(at.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["contacts-list"]],viewQuery:function(e,n){if(1&e&&t.Gf(rt,7),2&e){let a;t.iGM(a=t.CRH())&&(n.matDrawer=a.first)}},decls:40,vars:20,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","md:w-160","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col","overflow-hidden"],[1,"flex-auto","flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto","ng-tns-c241-22"],[1,"flex","flex-col","sm:flex-row","md:flex-col","py-8","px-6","md:px-8","border-b"],[1,"flex","items-center","mt-4","sm:mt-0","md:mt-4"],[1,"flex-auto"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","w-full","min-w-50"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder","input"],[1,"ml-2","fuse-mat-dense","fuse-mat-no-subscript","min-w-50"],[3,"value","placeholder","valueChange","selectionChange"],["selected","","value","pending"],["value","reported"],["value","negative"],["value","positive"],["value","all"],[1,"ml-2","fuse-mat-dense","fuse-mat-no-subscript","min-w-80"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","placeholder","Start date"],["matEndDate","","formControlName","end","placeholder","End date",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],["mat-flat-button","",1,"ml-2","text-green-800","bg-green-200","dark:text-green-100","dark:bg-green-500",3,"matTooltip","disabled","click"],[3,"svgIcon"],[1,"relative","overflow-hidden","sm:overflow-y-auto"],[4,"ngIf"],["class","sm:absolute sm:inset-x-0 sm:bottom-0 border-b sm:border-t sm:border-b-0 z-10 bg-gray-50 dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page",4,"ngIf"],["class","w-full min-h-250 flex flex-col flex-auto items-center justify-center ng-star-inserted",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"w-full","min-h-250","flex","flex-col","flex-auto","items-center","justify-center","ng-star-inserted"],[3,"diameter","mode"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-20","flex","items-center","px-6","md:px-8","cursor-pointer","border-b",3,"ngClass","routerLink"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","rounded-full","overflow-hidden"],[1,"min-w-0","w-full"],[1,"flex","flex-row","flex-auto","justify-between","md:px-8"],[3,"matTooltip"],["alt","Contact avatar",1,"object-cover","w-full","h-full",3,"src"],["noContacts",""],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"mat-drawer-container",1),t.NdJ("backdropClick",function(){return n.onBackdropClicked()}),t.TgZ(2,"mat-drawer",2,3),t._UZ(4,"router-outlet"),t.qZA(),t.TgZ(5,"mat-drawer-content",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t.TgZ(9,"div",8),t.TgZ(10,"mat-form-field",9),t._UZ(11,"mat-icon",10),t.TgZ(12,"input",11),t.NdJ("input",function(){return n.filterPatients(n.searchInputControl.value)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"mat-form-field",12),t.TgZ(14,"mat-select",13),t.NdJ("valueChange",function(c){return n.patientsFilter=c})("selectionChange",function(){return n.patientsFilterRun()}),t.TgZ(15,"mat-option",14),t._uU(16,"Pending"),t.qZA(),t.TgZ(17,"mat-option",15),t._uU(18,"Reported"),t.qZA(),t.TgZ(19,"mat-option",16),t._uU(20,"Negative"),t.qZA(),t.TgZ(21,"mat-option",17),t._uU(22,"Positive"),t.qZA(),t.TgZ(23,"mat-option",18),t._uU(24,"All"),t.qZA(),t.qZA(),t._UZ(25,"mat-icon",10),t.qZA(),t.TgZ(26,"mat-form-field",19),t.TgZ(27,"mat-date-range-input",20),t._UZ(28,"input",21),t.TgZ(29,"input",22),t.NdJ("dateChange",function(){return n.onDateChange()}),t.qZA(),t.qZA(),t._UZ(30,"mat-datepicker-toggle",23),t._UZ(31,"mat-date-range-picker",null,24),t.qZA(),t.TgZ(33,"button",25),t.NdJ("click",function(){return n.exportData()}),t._UZ(34,"mat-icon",26),t._uU(35," Export "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(36,"div",27),t.YNc(37,mt,3,3,"ng-container",28),t.YNc(38,pt,2,0,void 0,28),t.qZA(),t.qZA(),t.YNc(39,ht,1,9,"mat-paginator",29),t.qZA(),t.qZA(),t.qZA()),2&e){const a=t.MAs(32);t.xp6(2),t.Q6J("mode",n.drawerMode)("opened",!1)("position","end")("disableClose",!0),t.xp6(9),t.Q6J("svgIcon","heroicons_solid:search"),t.xp6(1),t.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Search patients"),t.xp6(2),t.Q6J("value",n.patientsFilter)("placeholder","Filter Patients"),t.xp6(11),t.Q6J("svgIcon","heroicons_outline:filter"),t.xp6(2),t.Q6J("formGroup",n.range)("rangePicker",a),t.xp6(3),t.Q6J("for",a),t.xp6(3),t.Q6J("matTooltip","Export")("disabled",!n.range.value.end),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:download"),t.xp6(3),t.Q6J("ngIf",n.contacts$),t.xp6(1),t.Q6J("ngIf",!n.contactsLoading),t.xp6(1),t.Q6J("ngIf",n.contacts$)}},directives:[Z.kh,Z.jA,m.lC,Z.LW,C.KE,y.Hw,C.qo,R.Nt,d.Fj,d.JJ,d.oH,J.gD,b.ey,h.wx,d.JL,d.sg,h.zY,d.u,h.By,h.nW,C.R9,h._g,T.lW,D.gM,v.O5,Y.Ou,v.sg,m.yS,v.mk,q.NW],encapsulation:2,changeDetection:0}),o})();var vt=s(87636),xt=s(54395),Ct=s(1400),Zt=s(58203),M=s(77001);const Tt=["avatarFileInput"],bt=["tagsPanel"],yt=["tagsPanelOrigin"];function At(o,r){if(1&o&&(t.ynx(0),t._UZ(1,"img",7),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contact.background,t.LSH)}}function Dt(o,r){if(1&o&&t._UZ(0,"img",31),2&o){const e=t.oxw(3);t.Q6J("src",e.contact.avatar,t.LSH)}}function Ft(o,r){if(1&o&&(t.TgZ(0,"div",32),t._uU(1),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.contact.first_name.charAt(0)," ")}}function kt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28),t._UZ(2,"mat-icon",5),t.TgZ(3,"div",33),t.TgZ(4,"span",21),t._uU(5),t.qZA(),t.qZA(),t.qZA(),t.BQk()),2&o){const e=r.$implicit;t.xp6(2),t.Q6J("svgIcon","iconsmind:hospital"),t.xp6(3),t.Oqu(e)}}function wt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",34),t._UZ(2,"mat-icon",5),t.TgZ(3,"div",35),t.ynx(4),t.TgZ(5,"div",36),t.TgZ(6,"a",37),t._uU(7),t.qZA(),t.qZA(),t.BQk(),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:mail"),t.xp6(4),t.Q6J("href","mailto:"+e.contact.email,t.LSH),t.xp6(1),t.hij(" ",e.contact.email," ")}}function It(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",34),t._UZ(2,"mat-icon",5),t.TgZ(3,"div",35),t.ynx(4),t.TgZ(5,"div",36),t.TgZ(6,"a",37),t._uU(7),t.qZA(),t.qZA(),t.BQk(),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:phone"),t.xp6(4),t.Q6J("href","tel:"+e.contact.phone_number.full,t.LSH),t.xp6(1),t.hij(" ",e.contact.phone_number.full," ")}}function Qt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28),t._UZ(2,"mat-icon",5),t.TgZ(3,"div",30),t._uU(4),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:location-marker"),t.xp6(2),t.HOy("",e.contact.address.addr_line1,", ",e.contact.address.city,", ",e.contact.address.state,", ",e.contact.address.postal,"")}}function Rt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",8),t.TgZ(1,"div",9),t.TgZ(2,"div",10),t.TgZ(3,"div",11),t.YNc(4,Dt,1,1,"img",12),t.YNc(5,Ft,2,1,"div",13),t.qZA(),t.TgZ(6,"div",14),t.TgZ(7,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleEditMode(!0)}),t._UZ(8,"mat-icon",16),t.TgZ(9,"span",17),t._uU(10,"Results"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",18),t._uU(12),t.qZA(),t.ynx(13),t.TgZ(14,"div",19),t.ynx(15),t.TgZ(16,"div",20),t.TgZ(17,"span",21),t._uU(18),t.qZA(),t.qZA(),t.TgZ(19,"div",20),t.TgZ(20,"span",21),t._uU(21),t.qZA(),t.qZA(),t.TgZ(22,"div",22),t.TgZ(23,"span",21),t._uU(24),t.qZA(),t.qZA(),t.TgZ(25,"div",23),t._UZ(26,"mat-icon",24),t.TgZ(27,"span",25),t._uU(28),t.qZA(),t.qZA(),t.BQk(),t.qZA(),t.BQk(),t.TgZ(29,"div",26),t.YNc(30,kt,6,2,"ng-container",27),t.ynx(31),t.TgZ(32,"div",28),t._UZ(33,"mat-icon",5),t.TgZ(34,"div",29),t._uU(35),t.qZA(),t.TgZ(36,"div",29),t._uU(37),t.qZA(),t._UZ(38,"mat-icon",5),t.qZA(),t.BQk(),t.YNc(39,wt,8,3,"ng-container",1),t.YNc(40,It,8,3,"ng-container",1),t.ynx(41),t.TgZ(42,"div",28),t._UZ(43,"mat-icon",5),t.TgZ(44,"div",30),t._uU(45),t.qZA(),t.qZA(),t.BQk(),t.YNc(46,Qt,5,5,"ng-container",1),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",e.contact.avatar),t.xp6(1),t.Q6J("ngIf",!e.contact.avatar),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:pencil-alt"),t.xp6(4),t.Oqu(e.contact.first_name+" "+e.contact.last_name),t.xp6(4),t.Q6J("matTooltip","Gender"),t.xp6(2),t.Oqu(e.contact.gender),t.xp6(1),t.Q6J("matTooltip","Location"),t.xp6(2),t.Oqu(e.contact.location),t.xp6(1),t.Q6J("matTooltip","Race"),t.xp6(2),t.Oqu(e.contact.race),t.xp6(1),t.Q6J("matTooltip","DOB"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:calendar"),t.xp6(2),t.Oqu(e.contact.date_of_birth.day+"/"+e.contact.date_of_birth.month+"/"+e.contact.date_of_birth.year),t.xp6(2),t.Q6J("ngForOf",e.contact.selected_tests),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:calendar"),t.xp6(2),t.Oqu(e.contact.collection_date.month+"/"+e.contact.collection_date.day+"/"+e.contact.collection_date.year),t.xp6(2),t.Oqu(e.contact.collection_time.timeInput+" "+e.contact.collection_time.ampm),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:clock"),t.xp6(1),t.Q6J("ngIf",e.contact.email),t.xp6(1),t.Q6J("ngIf",e.contact.phone_number),t.xp6(3),t.Q6J("svgIcon","iconsmind:folder_withdocument"),t.xp6(2),t.AsE("",e.contact.insurance_id,"(",e.contact.relationship_to_insured,")"),t.xp6(1),t.Q6J("ngIf",e.contact.address)}}const N=function(){return["../"]};function Jt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",2),t.YNc(2,At,2,1,"ng-container",1),t.TgZ(3,"div",3),t.TgZ(4,"button",4),t._UZ(5,"mat-icon",5),t.qZA(),t.qZA(),t.qZA(),t.YNc(6,Rt,47,24,"div",6),t.BQk()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.contact.background),t.xp6(2),t.Q6J("matTooltip","Close")("routerLink",t.DdM(5,N)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x"),t.xp6(1),t.Q6J("ngIf",e.contact)}}function St(o,r){if(1&o&&(t.ynx(0),t._UZ(1,"img",7),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contact.background,t.LSH)}}function Ut(o,r){if(1&o&&t._UZ(0,"img",31),2&o){const e=t.oxw(2);t.Q6J("src",e.contact.avatar,t.LSH)}}function Yt(o,r){if(1&o&&(t.TgZ(0,"div",32),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.contact.first_name.charAt(0)," ")}}const qt=function(){return{standalone:!0}};function Lt(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",2),t.YNc(2,St,2,1,"ng-container",1),t.TgZ(3,"div",3),t.TgZ(4,"button",4),t._UZ(5,"mat-icon",38),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div",39),t.TgZ(7,"div",9),t.TgZ(8,"form",40),t.TgZ(9,"div",10),t.TgZ(10,"div",41),t.YNc(11,Ut,1,1,"img",12),t.YNc(12,Yt,2,1,"div",13),t.qZA(),t.qZA(),t.TgZ(13,"div",42),t.TgZ(14,"span",43),t._uU(15,"Test Results"),t.qZA(),t.TgZ(16,"mat-radio-group",44),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().contact.test_result=a})("change",function(){return t.CHM(e),t.oxw().resultSelectedUpdated()}),t.TgZ(17,"mat-radio-button",45),t._uU(18," Positive "),t.qZA(),t.TgZ(19,"mat-radio-button",45),t._uU(20," Negative "),t.qZA(),t.TgZ(21,"mat-radio-button",46),t._uU(22," UnCertain "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div",47),t.TgZ(24,"button",48),t.NdJ("click",function(){return t.CHM(e),t.oxw().deleteContact()}),t._uU(25," Delete "),t.qZA(),t.TgZ(26,"button",49),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleEditMode(!1)}),t._uU(27," Cancel "),t.qZA(),t.TgZ(28,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().updateContact()}),t._uU(29," Save "),t.qZA(),t.TgZ(30,"button",51),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendEmail()}),t._UZ(31,"mat-icon",5),t._uU(32," Send Email "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.contact.background),t.xp6(2),t.Q6J("matTooltip","Close")("routerLink",t.DdM(22,N)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x"),t.xp6(3),t.Q6J("formGroup",e.contactForm),t.xp6(3),t.Q6J("ngIf",e.contact.avatar),t.xp6(1),t.Q6J("ngIf",!e.contact.avatar),t.xp6(4),t.Q6J("color","primary")("ngModel",e.contact.test_result)("ngModelOptions",t.DdM(23,qt)),t.xp6(1),t.Q6J("value","positive"),t.xp6(2),t.Q6J("value","negative"),t.xp6(2),t.Q6J("value","uncertain"),t.xp6(3),t.Q6J("color","warn")("matTooltip","Delete"),t.xp6(2),t.Q6J("matTooltip","Cancel"),t.xp6(2),t.Q6J("color","primary")("disabled",!e.contact.test_result)("matTooltip","Save"),t.xp6(2),t.Q6J("matTooltip","Send Email")("disabled",!e.contact.test_result),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:mail")}}const Mt=[{path:"",component:X,resolve:{tags:K},children:[{path:"",component:L,resolve:{tasks:V,countries:W},children:[{path:":id",component:(()=>{class o{constructor(e,n,a,c,i,l,u,f,_,k,w,I){this._activatedRoute=e,this._changeDetectorRef=n,this._contactsListComponent=a,this._contactsService=c,this._formBuilder=i,this._fuseConfirmationService=l,this._renderer2=u,this._router=f,this._overlay=_,this._formsService=k,this._viewContainerRef=w,this._snackBar=I,this.editMode=!1,this.tagsEditMode=!1,this._unsubscribeAll=new U.xQ}ngOnInit(){var e=this;return(0,g.Z)(function*(){const n=e._activatedRoute.snapshot.params;e._contactsListComponent.matDrawer.open(),e.contactForm=e._formBuilder.group({id:[""],avatar:[null],name:["",[d.kI.required]],emails:e._formBuilder.array([]),phoneNumbers:e._formBuilder.array([]),title:[""],company:[""],birthday:[null],address:[null],notes:[null],tags:[[]]}),e.contact_id=n.id,e.contact=yield e._formsService.getFormData(n.id),e._contactsService.countries$.pipe((0,p.R)(e._unsubscribeAll)).subscribe(a=>{e.countries=a,e._changeDetectorRef.markForCheck()}),e._contactsService.tags$.pipe((0,p.R)(e._unsubscribeAll)).subscribe(a=>{e.tags=a,e.filteredTags=a,e._changeDetectorRef.markForCheck()})})()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._contactsListComponent.matDrawer.close()}toggleEditMode(e=null){this.editMode=null===e?!this.editMode:e,this._changeDetectorRef.markForCheck()}resultSelectedUpdated(){this.contact.report_status="reported";const n=S().format("MM/DD/YYYY HH:mm A");this.contact.reported_date=n}updateContact(){var e=this;return(0,g.Z)(function*(){yield e._formsService.updateFormResults(e.contact_id,e.contact),e.toggleEditMode(!1)})()}sendEmail(){var e=this;return(0,g.Z)(function*(){yield e._formsService.sendReportEmail(e.contact),e._snackBar.open(`Report sent to ${e.contact.email}`,"Done")})()}deleteContact(){this._fuseConfirmationService.open({title:"Delete contact",message:"Are you sure you want to delete this contact? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(n=>{if("confirmed"===n){const a=this.contact.id,c=this.contacts.findIndex(u=>u.id===a),i=c+(c===this.contacts.length-1?-1:1),l=1===this.contacts.length&&this.contacts[0].id===a?null:this.contacts[i].id;this._contactsService.deleteContact(a).subscribe(u=>{!u||(this._router.navigate(l?["../",l]:["../"],{relativeTo:this._activatedRoute}),this.toggleEditMode(!1))}),this._changeDetectorRef.markForCheck()}})}uploadAvatar(e){if(!e.length)return;const a=e[0];!["image/jpeg","image/png"].includes(a.type)||this._contactsService.uploadAvatar(this.contact.id,a).subscribe()}removeAvatar(){this.contactForm.get("avatar").setValue(null),this._avatarFileInput.nativeElement.value=null,this.contact.avatar=null}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._renderer2.addClass(this._tagsPanelOrigin.nativeElement,"panel-opened"),this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});const e=new vt.UE(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(e),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._renderer2.removeClass(this._tagsPanelOrigin.nativeElement,"panel-opened"),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),e&&e.isAttached&&e.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){const n=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(a=>a.title.toLowerCase().includes(n))}filterTagsInputKeyDown(e){if("Enter"!==e.key)return;if(0===this.filteredTags.length)return this.createTag(e.target.value),void(e.target.value="");const n=this.filteredTags[0];this.contact.tags.find(c=>c===n.id)?this.removeTagFromContact(n):this.addTagToContact(n)}createTag(e){this._contactsService.createTag({title:e}).subscribe(a=>{this.addTagToContact(a)})}updateTagTitle(e,n){e.title=n.target.value,this._contactsService.updateTag(e.id,e).pipe((0,xt.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._contactsService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToContact(e){this.contact.tags.unshift(e.id),this.contactForm.get("tags").patchValue(this.contact.tags),this._changeDetectorRef.markForCheck()}removeTagFromContact(e){this.contact.tags.splice(this.contact.tags.findIndex(n=>n===e.id),1),this.contactForm.get("tags").patchValue(this.contact.tags),this._changeDetectorRef.markForCheck()}toggleContactTag(e){this.contact.tags.includes(e.id)?this.removeTagFromContact(e):this.addTagToContact(e)}shouldShowCreateTagButton(e){return!(""===e||this.tags.findIndex(n=>n.title.toLowerCase()===e.toLowerCase())>-1)}addEmailField(){const e=this._formBuilder.group({email:[""],label:[""]});this.contactForm.get("emails").push(e),this._changeDetectorRef.markForCheck()}removeEmailField(e){this.contactForm.get("emails").removeAt(e),this._changeDetectorRef.markForCheck()}addPhoneNumberField(){const e=this._formBuilder.group({country:["us"],phoneNumber:[""],label:[""]});this.contactForm.get("phoneNumbers").push(e),this._changeDetectorRef.markForCheck()}removePhoneNumberField(e){this.contactForm.get("phoneNumbers").removeAt(e),this._changeDetectorRef.markForCheck()}getCountryByIso(e){return this.countries.find(n=>n.iso===e)}trackByFn(e,n){return n.id||e}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.gz),t.Y36(t.sBO),t.Y36(L),t.Y36(x.P),t.Y36(d.qu),t.Y36(Ct.R),t.Y36(t.Qsj),t.Y36(m.F0),t.Y36(Zt.aV),t.Y36(F),t.Y36(t.s_b),t.Y36(M.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["contacts-details"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Tt,5),t.Gf(bt,5),t.Gf(yt,5)),2&e){let a;t.iGM(a=t.CRH())&&(n._avatarFileInput=a.first),t.iGM(a=t.CRH())&&(n._tagsPanel=a.first),t.iGM(a=t.CRH())&&(n._tagsPanelOrigin=a.first)}},decls:3,vars:2,consts:[[1,"flex","flex-col","w-full"],[4,"ngIf"],[1,"relative","w-full","h-40","sm:h-48","px-8","sm:px-12","bg-accent-100","dark:bg-accent-700"],[1,"flex","items-center","justify-end","w-full","max-w-3xl","mx-auto","pt-6"],["mat-icon-button","",3,"matTooltip","routerLink"],[3,"svgIcon"],["class","relative flex flex-col flex-auto items-center p-6 pt-0 sm:p-12 sm:pt-0",4,"ngIf"],[1,"absolute","inset-0","object-cover","w-full","h-full",3,"src"],[1,"relative","flex","flex-col","flex-auto","items-center","p-6","pt-0","sm:p-12","sm:pt-0"],[1,"w-full","max-w-3xl"],[1,"flex","flex-auto","items-end","-mt-16"],[1,"flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],["class","object-cover w-full h-full",3,"src",4,"ngIf"],["class","flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200",4,"ngIf"],[1,"flex","items-center","ml-auto","mb-1"],["mat-stroked-button","",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],[1,"mt-3","text-4xl","font-bold","truncate"],[1,"flex","flex-wrap","items-center","mt-2"],[1,"flex","items-center","justify-center","py-1","px-3","mr-3","mb-3","rounded-full","leading-normal","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700",3,"matTooltip"],[1,"text-sm","font-medium","whitespace-nowrap"],[1,"flex","items-center","justify-center","py-1","px-3","mr-3","rounded-full","mb-3","leading-normal","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700",3,"matTooltip"],[1,"flex","items-center","justify-center","py-1","px-3","mr-3","mb-3","leading-normal","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700",3,"matTooltip"],[2,"min-width","20px","width","20px",3,"svgIcon"],[1,"text-sm","ml-2","font-medium","whitespace-nowrap"],[1,"flex","flex-col","mt-4","pt-6","border-t","space-y-8"],[4,"ngFor","ngForOf"],[1,"flex","sm:items-center"],[1,"ml-3","leading-6"],[1,"ml-6","leading-6"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded","overflow-hidden","uppercase","text-8xl","font-bold","leading-none","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"flex","items-center","justify-center","py-1","px-3","mr-3","ml-3","leading-normal","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"flex"],[1,"min-w-0","ml-6","space-y-1"],[1,"flex","items-center","leading-6"],["target","_blank",1,"hover:underline","text-primary-500",3,"href"],[1,"text-white",3,"svgIcon"],[1,"relative","flex","flex-col","flex-auto","items-center","px-6","sm:px-12"],[3,"formGroup"],[1,"relative","flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],[1,"mt-8"],[1,"font-semibold"],[1,"flex","flex-col","mt-5",3,"color","ngModel","ngModelOptions","ngModelChange","change"],[1,"mb-2",3,"value"],[3,"value"],[1,"flex","items-center","mt-10","-mx-6","sm:-mx-12","py-4","pr-4","pl-1","sm:pr-12","sm:pl-7","border-t","bg-gray-50","dark:bg-transparent"],["mat-button","",3,"color","matTooltip","click"],["mat-button","",1,"ml-auto",3,"matTooltip","click"],["mat-flat-button","",1,"ml-2",3,"color","disabled","matTooltip","click"],["mat-flat-button","",1,"ml-2","text-green-800","bg-green-200","dark:text-green-100","dark:bg-green-500",3,"matTooltip","disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Jt,7,6,"ng-container",1),t.YNc(2,Lt,33,24,"ng-container",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!n.editMode&&n.contact),t.xp6(1),t.Q6J("ngIf",n.editMode))},directives:[v.O5,T.lW,D.gM,m.rH,y.Hw,v.sg,d._Y,d.JL,d.sg,A.VQ,d.JJ,d.On,A.U0],encapsulation:2,changeDetection:0}),o})(),canDeactivate:[$]}]}]}];var Nt=s(11494);let Bt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[F,{provide:b.sG,useValue:{parse:{dateInput:S.ISO_8601},display:{dateInput:"LL",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}}}],imports:[[m.Bz.forChild(Mt),T.ot,B.p9,h.FA,Nt.JX,M.ZX,O.t,C.lN,q.TU,y.Ps,R.c,P.Tx,E.Yd,j.Cv,Y.Cq,A.Fk,b.si,J.LD,Z.SJ,H.p0,D.AV,z.V,G.m]]}),o})()}}]);